<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2026년 안전&환경 서류 체크리스트</title>
    <!-- PDF 라이브러리 (기존) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <!-- 엑셀 라이브러리 (SheetJS) - 신규 추가됨 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="header-left">
                <h1>📋 2026년 안전&환경 서류 체크리스트</h1>
                <p>원도급 업체 대상 (발주처 기준 작성)</p>
                <p id="updateDate">최종 업데이트: 2026년 1월 24일</p>
            </div>
            <div class="header-right" style="font-size: 14px;">🏢 설비기획그룹 제작</div>
        </div>

        <!-- Input Section -->
        <div class="input-section">
            <div class="input-grid">
                <div class="input-group">
                    <label for="projectName">📁 투자명</label>
                    <input type="text" id="projectName" placeholder="예: 양극재 공장 신축" value="">
                </div>
                <div class="input-group">
                    <label for="companyName">🏢 업체명</label>
                    <input type="text" id="companyName" placeholder="예: 대금산업" value="">
                </div>
                <div class="input-group">
                    <label for="contractAmount">💰 공사금액</label>
                    <div class="slider-container">
                        <input type="range" id="contractAmount" min="0" max="100" value="50" step="0.1">
                        <input type="text" id="contractAmountInput" class="number-input" value="50" placeholder="금액" inputmode="decimal">
                        <div class="value-display">억원</div>
                    </div>
                </div>
                <div class="input-group">
                    <label for="contractPeriod">⏱️ 공사기간</label>
                    <div class="slider-container">
                        <input type="range" id="contractPeriod" min="0.5" max="36" value="12" step="0.5">
                        <input type="text" id="contractPeriodInput" class="number-input" value="12" placeholder="기간" inputmode="decimal">
                        <div class="value-display">개월</div>
                    </div>
                </div>
            </div>

            <div class="info-box">
                ℹ️ 공사금액과 공사기간을 조절하면 해당 기준에 따라 필수 여부가 자동으로 변환됩니다. 모든 서류 현황을 한눈에 확인한 후 PDF 저장 또는 인쇄하세요.
            </div>

            <div class="button-group">
                <button class="btn-primary" id="updateBtn" onclick="updateAndNotify()">📊 체크리스트 업데이트</button>
                <button class="btn-print" onclick="printPage()">🖨️ 인쇄&PDF저장</button>
                <!-- 엑셀 버튼 추가됨 -->
                <button class="btn-excel" onclick="downloadExcel()">📥 엑셀 다운로드</button>
                <button class="btn-reset" onclick="resetForm()">🔄 초기화</button>
            </div>
        </div>

        <!-- Step Navigation -->
        <div class="step-nav" id="stepNav">
            <button class="step-tab active" onclick="switchStep(1)">Ⅰ. 안전&환경 <span class="doc-count" id="count1"></span></button>
            <button class="step-tab" onclick="switchStep(2)">Ⅱ. 시공계획서 <span class="doc-count" id="count2"></span></button>
            <button class="step-tab" onclick="switchStep(3)">Ⅲ. 착공계 <span class="doc-count" id="count3"></span></button>
            <button class="step-tab" onclick="switchStep(4)">Ⅳ. 착공 시(당일) <span class="doc-count" id="count4"></span></button>
        </div>

        <!-- Table Section -->
        <div class="table-section">
            <div id="step1" class="step-content active"></div>
            <div id="step2" class="step-content"></div>
            <div id="step3" class="step-content"></div>
            <div id="step4" class="step-content"></div>
        </div>
    </div>

    <!-- Reference Modal -->
    <div id="referenceModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal()">&times;</span>
            <div id="modalBody"></div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
